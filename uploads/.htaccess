# حماية مجلد uploads
# السماح بعرض الملفات (الصور، PDF) فقط
# منع تنفيذ ملفات PHP

# منع تنفيذ PHP
<FilesMatch "\.(php|phtml|php3|php4|php5|php7|phps)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# السماح بأنواع الملفات المسموحة فقط
<FilesMatch "\.(jpg|jpeg|png|gif|webp|pdf|doc|docx|xls|xlsx|ppt|pptx|mp4|mp3)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# منع عرض محتوى المجلد
Options -Indexes

# حماية من Hotlinking (استخدام الصور من مواقع أخرى)
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?yourdomain.com [NC]
RewriteRule \.(jpg|jpeg|png|gif|webp)$ - [F]
